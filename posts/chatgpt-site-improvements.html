<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Shana" />
      <meta name="date" content="2023-02-27" />
    <meta name="keywords" content="false, nothing" />
  <link rel="stylesheet" href=../assets/css/styles.css>
  <title>chatgpt-site-improvements</title>
  <link rel="shortcut icon" type="image/jpg"
  href="../assets/favicons/frog_favicon.ico" />
</head>

<body>
  <header class="header">
    <div class="logo"><a href="/">Shana Matthews</a></div>
    <nav class="header-links">
      <ul>
        <li><a href="/about/">About</a></li>
        <!-- <li><a href="/contact/">Contact</a></li> -->
        <li><a href="/posts/">Posts</a></li>
        <li><a href="/talks/">Talks</a></li>
        <li><a href="/reading/">What am I reading?</a></li>
      </ul>
    </nav>
  </header>
    <h1 class="title">chatgpt-site-improvements</h1>
      <p class="date">2023-02-27</p>
    <p>I’ve been in a personal-projects slump recently, as evidenced by
    my GitHub activity chart, yikes.</p>
    <p><img src="../images/github-dots.png" /></p>
    <p>This is mostly because of some health stuff that came up early in
    January and I’m still dealing with. However, I’ve been doing better
    over the last couple of weeks and I’ve found some energy and
    excitement to start playing around, particularly with
    ChatGPT-related things.</p>
    <h3 id="this-website">This website</h3>
    <p>I’m really proud of myself for creating this site with my own
    static site generator <a
    href="./static-site-generator-with-bash.html">written with just Bash
    scripts</a>. I think it’s sick and it aligns with my stance on not
    needing a framework or fancy tech to do every single thing.</p>
    <p>However the reality is… I kinda suck at Bash scripting. I don’t
    use Bash regularly at work, or even in personal projects, so
    whenever I want to go in to make tweaks to this site, I always feel
    super rusty and it takes ages just to remember how this very simple
    project works. That means that adding new “features” like the
    ability to have draft posts feels really tedious.</p>
    <p>That’s where ChatGPT comes in! I’d read some really promising
    things about folks using ChatGPT to help them with super simple
    scripting and I wanted to try it out with this site.</p>
    <p>I tested out ChatGPT by feeding it my <a
    href="https://github.com/shanamatthews/static-site-generator/blob/main/build"><code>build</code>
    script</a> and asking what it did. It was very accurate!
    Impressive!</p>
    <blockquote>
    <p>This script is used to build a static website. Here’s a
    step-by-step explanation of what it does:</p>
    <p>The first line (#!/usr/bin/env bash) specifies that the script
    should be run using the bash shell.</p>
    <p>The second line (shopt -s globstar) enables the globstar option,
    which allows the use of double asterisks (**) as a recursive
    directory wildcard.</p>
    <p>The script declares an array called unsorted_posts to hold the
    file names of all the Markdown files in the posts directory
    (excluding the index.md file) sorted by date in descending
    order.</p>
    <p>The for loop iterates over each file in the posts directory
    (excluding the index.md file), extracts the date from the front
    matter of each file using sed, and constructs a new file name by
    prefixing the date to the original file name. This new file name is
    then added to the unsorted_posts array.</p>
    <p>The script declares another array called sorted_posts and sets
    its value to the sorted version of unsorted_posts.</p>
    <p>The script declares another array called latest_posts and fills
    it with a list of variables to be passed to the pandoc command when
    building the posts/index.md page.</p>
    <p>The script extracts the latest post from sorted_posts and
    generates the HTML code for the latest post preview using
    pandoc.</p>
    <p>The script iterates over each Markdown file in the current
    directory and its subdirectories. For each file, it extracts the
    file name and directory, determines whether it is the homepage,
    posts page, or a regular page, and generates the corresponding HTML
    code using pandoc. The assets-folder variable is set to assets for
    pages in the current directory, and ../assets for pages in
    subdirectories.</p>
    <p>The generated HTML files are stored in the same directories as
    their corresponding Markdown files.</p>
    <p>Overall, this script generates a static website from Markdown
    files by converting them to HTML using pandoc and a custom HTML
    template. The homepage and posts page are generated separately from
    the other pages, and the latest post preview is included on the
    posts page.</p>
    </blockquote>
    <p>Feeling confident about ChatGPT’s abilities, I asked it how I
    could edit the script such that if a post has
    <code>draft: true</code> in the frontmatter, the script won’t
    generate an html page for it.</p>
    <p>Here was it’s response:</p>
    <blockquote>
    <div class="sourceCode" id="cb1"><pre
    class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="bu">shopt</span> <span class="at">-s</span> globstar</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="bu">declare</span> <span class="at">-a</span> <span class="va">unsorted_posts</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> post <span class="kw">in</span> <span class="va">$(</span><span class="fu">ls</span> <span class="at">-t</span> posts/<span class="pp">*</span>.md<span class="va">)</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span> <span class="kw">[[</span> <span class="va">$post</span> <span class="ot">!=</span> <span class="st">&quot;posts/index.md&quot;</span> <span class="kw">]];</span> <span class="cf">then</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Check for &#39;draft: true&#39; in front matter</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span> <span class="fu">grep</span> <span class="at">-q</span> <span class="st">&#39;draft: true&#39;</span> <span class="st">&quot;</span><span class="va">$post</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>     <span class="cf">continue</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>   <span class="cf">fi</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>   <span class="va">post_date</span><span class="op">=</span><span class="va">$(</span><span class="fu">sed</span> <span class="at">-n</span> <span class="st">&#39;s/^date: //p&#39;</span> <span class="va">${post})</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>   <span class="va">post_name</span><span class="op">=</span><span class="va">$(</span><span class="fu">basename</span> <span class="va">$post)</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>   <span class="va">post_name</span><span class="op">=</span><span class="st">&quot;</span><span class="va">${post_date}</span><span class="st">_</span><span class="va">${post_name}</span><span class="st">&quot;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>   <span class="va">unsorted_posts</span><span class="op">+=</span><span class="va">(${post_name})</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a> <span class="cf">fi</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="ex">...</span></span></code></pre></div>
    </blockquote>
    <p>This was kinda right, but if “draft: true” appeared anywhere in
    the post, it would skip it. It’s not likely that I’d write that
    phrase outside of the frontmatter, but I’d rather not run into that
    weird and confusing bug later.</p>
    <p>With a little more prompting, ChatGPT gave me a better
    answer:</p>
    <blockquote>
    <div class="sourceCode" id="cb2"><pre
    class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="bu">shopt</span> <span class="at">-s</span> globstar</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">declare</span> <span class="at">-a</span> <span class="va">unsorted_posts</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> post <span class="kw">in</span> <span class="va">$(</span><span class="fu">ls</span> <span class="at">-t</span> posts/<span class="pp">*</span>.md<span class="va">)</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span> <span class="kw">[[</span> <span class="va">$post</span> <span class="ot">!=</span> <span class="st">&quot;posts/index.md&quot;</span> <span class="kw">]];</span> <span class="cf">then</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Extract the front matter and check if it contains &quot;draft: true&quot;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>   <span class="va">front_matter</span><span class="op">=</span><span class="va">$(</span><span class="fu">sed</span> <span class="at">-n</span> <span class="st">&#39;/^---$/,/^---$/p&#39;</span> <span class="st">&quot;</span><span class="va">${post}</span><span class="st">&quot;</span><span class="va">)</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span> <span class="kw">[[</span> <span class="va">${front_matter}</span> <span class="ot">==</span> <span class="pp">*</span><span class="st">&quot;draft: true&quot;</span><span class="pp">*</span> <span class="kw">]];</span> <span class="cf">then</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>      <span class="cf">continue</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>   <span class="cf">fi</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Extract the post date and name</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>   <span class="va">post_date</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">${front_matter}</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="at">-n</span> <span class="st">&#39;s/^date: //p&#39;</span><span class="va">)</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>   <span class="va">post_name</span><span class="op">=</span><span class="va">$(</span><span class="fu">basename</span> <span class="va">$post)</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>   <span class="va">post_name</span><span class="op">=</span><span class="st">&quot;</span><span class="va">${post_date}</span><span class="st">_</span><span class="va">${post_name}</span><span class="st">&quot;</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>   <span class="va">unsorted_posts</span><span class="op">+=</span><span class="va">(${post_name})</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a> <span class="cf">fi</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="ex">...</span></span></code></pre></div>
    </blockquote>
    <p>Nice! That works much better. It also grabbed the post date from
    the frontmatter specifically, which is better than what I was doing
    before. Stylistically, I don’t like to echo something into
    <code>sed</code> (not sure why…), so I updated the script to instead
    feed the post frontmatter to stdin for <code>sed</code> to use, but
    otherwise, this worked! Ship it!</p>
    <p>After my success using ChatGPT for this, I was also inspired to
    have ChatGPT edit this script, as well as the <a
    href="https://github.com/shanamatthews/static-site-generator/blob/main/create-post"><code>create-post</code>
    script</a> to print out error messages when something goes wrong.
    I’d been too lazy to do this and ChatGPT made it really easy.</p>
    </body>
<footer>
  <p>Powered by <a href="https://github.com/shanamatthews/static-site-generator">Shana's custom static site
      generator</a> (aka literally just one Bash script)</insert>
  </p>
  <p>Theme inspired by ✨<a href="https://sailorhg.github.io/fairyfloss/">sailorhg's Fairyfloss</a> ✨</p>
  <a rel="me" href="https://mastodon.social/@shanacodes"></a>
</footer>
<script src="/assets/main.js"></script>

</html>
